<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n l√Ω H√≥a ƒë∆°n & T·ªìn kho</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.4.120/build/pdf.min.js"></script>
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
</head>
<body>
  <header class="header-total">
    <div class="control-bar">
      <button onclick="showManualInvoiceForm()">‚ûï H√≥a ƒë∆°n th·ªß c√¥ng</button>
      <button onclick="showManualInventoryForm()">‚ûï T·ªìn kho th·ªß c√¥ng</button>
      <button onclick="exportInventoryToExcel()">üìä Xu·∫•t Excel T·ªìn kho</button>
      <button onclick="exportPriceListToExcel()">üìä Xu·∫•t Excel B·∫£ng gi√°</button>
      <button onclick="clearAllData()">üóëÔ∏è X√≥a d·ªØ li·ªáu</button>
      <button id="duplicateToggle" onclick="toggleDuplicateCheck()" title="T·∫Øt Tr√πng H√≥a ƒë∆°n: B·∫¨T">üîÑ Tr√πng l·∫∑p</button>
    </div>
  </header>

  <div class="container">
    <div class="sidebar">
      <input type="file" id="pdfInput" accept="application/pdf" multiple>
      <div id="status"></div>
      <input type="text" id="searchInput" placeholder="T√¨m ki·∫øm H·ªô Kinh Doanh...">
      <div id="searchResults"></div>
      <div id="businessList"></div>
    </div>

    <div class="main-content">
      <div id="invoiceInfo"></div>
      <div id="businessDetails">
        <h4>Chi ti·∫øt H·ªô Kinh Doanh</h4>
        
        <!-- Tab Header -->
        <div class="tabs">
          <button class="tab-button active" onclick="switchTab('lowStock')">T·ªìn kho s·∫Øp h·∫øt</button>
          <button class="tab-button" onclick="switchTab('stockTable')">B·∫£ng t·ªìn kho</button>
          <button class="tab-button" onclick="switchTab('invoiceList')">Danh s√°ch h√≥a ƒë∆°n</button>
          <button class="tab-button" onclick="switchTab('priceList')">B·∫£ng gi√° b√°n</button>
        </div>

        <!-- Tab Content -->
        <div id="tab-lowStock" class="tab-content">
          <p>‚ö†Ô∏è Ch∆∞a c√≥ d·ªØ li·ªáu. Vui l√≤ng ch·ªçn H·ªô Kinh Doanh.</p>
        </div>
        <div id="tab-stockTable" class="tab-content hidden"></div>
        <div id="tab-invoiceList" class="tab-content hidden"></div>
        <div id="tab-priceList" class="tab-content hidden"></div>
      </div>

      <div id="manualInvoiceForm" class="section hidden">
        <h4>Nh·∫≠p H√≥a ƒë∆°n Th·ªß c√¥ng</h4>
        <div class="section-content">
          <div class="controls">
            <select id="manualInvoiceType">
              <option value="input">Nh·∫≠p</option>
              <option value="output">Xu·∫•t</option>
            </select>
            <input type="date" id="manualInvoiceDate">
            <input type="text" id="manualInvoiceNumber" placeholder="S·ªë h√≥a ƒë∆°n">
            <input type="text" id="manualInvoiceCode" placeholder="M√£ h√≥a ƒë∆°n">
          </div>
          <table class="compact-table">
            <thead>
              <tr>
                <th>T√™n h√†ng h√≥a</th><th>ƒê∆°n v·ªã</th><th>S·ªë l∆∞·ª£ng</th><th>ƒê∆°n gi√°</th><th>Thu·∫ø su·∫•t</th><th>Th√†nh ti·ªÅn</th><th>Thao t√°c</th>
              </tr>
            </thead>
            <tbody id="manualInvoiceItemsBody"></tbody>
          </table>
          <div class="controls">
            <button onclick="addManualInvoiceItem()">‚ûï Th√™m s·∫£n ph·∫©m</button>
            <button onclick="saveManualInvoice()">üíæ L∆∞u</button>
            <button onclick="hideManualInvoiceForm()">‚ùå H·ªßy</button>
          </div>
        </div>
      </div>

      <div id="manualInventoryForm" class="section hidden">
        <h4>Nh·∫≠p T·ªìn kho Th·ªß c√¥ng</h4>
        <div class="section-content">
          <table class="compact-table">
            <thead>
              <tr>
                <th>T√™n h√†ng h√≥a</th><th>ƒê∆°n v·ªã</th><th>S·ªë l∆∞·ª£ng</th><th>ƒê∆°n gi√°</th><th>Thu·∫ø su·∫•t</th><th>Th√†nh ti·ªÅn</th><th>Thao t√°c</th>
              </tr>
            </thead>
            <tbody id="manualInventoryItemsBody"></tbody>
          </table>
          <div class="controls">
            <button onclick="addManualInventoryItem()">‚ûï Th√™m s·∫£n ph·∫©m</button>
            <button onclick="saveManualInventory()">üíæ L∆∞u</button>
            <button onclick="hideManualInventoryForm()">‚ùå H·ªßy</button>
          </div>
        </div>
      </div>

      <textarea id="pdfTextArea" style="display:none;"></textarea>
    </div>
  </div>

  <script>
    function switchTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
      document.querySelectorAll('.tab-button').forEach(el => el.classList.remove('active'));
      document.getElementById('tab-' + tabId).classList.remove('hidden');
      document.querySelector(`.tab-button[onclick*="${tabId}"]`).classList.add('active');
    }

    // H√†m t·∫Øt form th·ªß c√¥ng
    function hideManualInvoiceForm() {
      document.getElementById('manualInvoiceForm').classList.add('hidden');
    }

    function hideManualInventoryForm() {
      document.getElementById('manualInventoryForm').classList.add('hidden');
    }
  </script>

  <script src="script.js"></script>
</body>
</html>